<!DOCTYPE html><html lang='en'><head><title>Code Outline</title><style> * {font-weight:bold;padding-left:2rem;}.filename {padding-left:0em;}.docstring { font-weight:normal; color:green;}.docstring.text { font-weight:normal; color:green;}.class {color:blue;}.def {color:orange; }.text {color:black; font-size:1rem; font-weight:normal; }</style></head><body><div class = 'filename'>make_outline.py</div><details><summary><span class='docstring'>docstring</span></summary><div class ='docstring text'>    This may be the most promising for very lightweight semi-automatic documentation
</div>
<div class ='docstring text'>    + classes make it neat and readable
</div>
<div class ='docstring text'>    + it works
</div>
<div class ='docstring text'>
</div>
<div class ='docstring text'>    Next steps
</div>
<div class ='docstring text'>        - ensure that 'firstline' handles multiline argument lists '(' to ')'
</div>
<div class ='docstring text'>        - tidy up the html formatting
</div>
<div class ='docstring text'>            - several functions for different layouts?
</div>
<div class ='docstring text'>            - sort out indentation in body text
</div>
<div class ='docstring text'>            - check if characters in main need escaping 
</div>
</details><details><summary><span class='text'>text</span></summary><div class ='text text'>
</div>
</details><details><summary><span class ='class'>class docobj:</span></summary><details><summary><span class='def'>def __init__(self, firstline):</span></summary><div class ='def text'>        self.firstline = firstline.strip()
</div>
<div class ='def text'>        self.html_class = self.firstline.split(" ")[0]
</div>
<div class ='def text'>        self.docstring =[]
</div>
<div class ='def text'>        self.lines = []
</div>
<div class ='def text'>        self.indent_spaces = len(firstline) - len(firstline.lstrip())
</div>
<div class ='def text'>        self.indent_level = 0
</div>
<div class ='def text'>
</div>
</details></details><details><summary><span class ='class'>class get_doc:</span></summary><details><summary><span class ='def'>def __init__(self,filepath, objtypes):</span></summary><details><summary><span class='docstring'>docstring</span></summary><div class ='docstring text'>            document-level properties and file reader / preprocessor
</div>
<div class ='docstring text'>            completes with self.objects containing parsed docobjects
</div>
</details><details><summary><span class='text'>text</span></summary><div class ='text text'>        self.objects = []
</div>
<div class ='text text'>        indent_level = 0
</div>
<div class ='text text'>        indent_spaces = 0
</div>
<div class ='text text'>        # get input file into lines
</div>
<div class ='text text'>        with open(filepath,"r") as f:
</div>
<div class ='text text'>            lines = f.readlines()
</div>
<div class ='text text'>        # replace all opening docstring markers with 'docstring'
</div>
<div class ='text text'>        # replace all closing docstring makers with 'text'
</div>
<div class ='text text'>        opening = True
</div>
<div class ='text text'>        for idx, line in enumerate(lines):
</div>
<div class ='text text'>            if(('"""' in line) and not ('"""' in line.replace('"""','',1))):
</div>
<div class ='text text'>                rep = 'docstring' if opening else 'text'
</div>
<div class ='text text'>                opening = not opening
</div>
<div class ='text text'>                lines[idx] = line.replace('docstring',rep)
</div>
<div class ='text text'>
</div>
<div class ='text text'>        # find document objects and remember the line number they start at
</div>
<div class ='text text'>        line_index = []
</div>
<div class ='text text'>        for line_no, line in enumerate(lines):
</div>
<div class ='text text'>            for p in objtypes:
</div>
<div class ='text text'>                if line.strip().startswith(p):
</div>
<div class ='text text'>                    self.objects.append(docobj(line))
</div>
<div class ='text text'>                    line_index.append(line_no)
</div>
<div class ='text text'>
</div>
<div class ='text text'>        # fill the object.lines[] with the text within the object
</div>
<div class ='text text'>        for obj_ind, obj_start_line_no in enumerate(line_index):
</div>
<div class ='text text'>            obj = self.objects[obj_ind]
</div>
<div class ='text text'>            last_line = line_index[obj_ind+1] if obj_ind < len(self.objects)-1 else len(lines)
</div>
<div class ='text text'>            for obj_line_ind in range(obj_start_line_no, last_line):
</div>
<div class ='text text'>                obj.lines.append(f"{lines[obj_line_ind]}")
</div>
<div class ='text text'>
</div>
<div class ='text text'>        # tell the object what its indent level is within the document
</div>
<div class ='text text'>        indents =[0]
</div>
<div class ='text text'>        for obj in self.objects:
</div>
<div class ='text text'>            if(obj.indent_spaces > indents[-1]):
</div>
<div class ='text text'>                indents.append(obj.indent_spaces)
</div>
<div class ='text text'>            obj.indent_level = indents.index(obj.indent_spaces)
</div>
<div class ='text text'>
</div>
</details></details><details><summary><span class='def'>def html_head():</span></summary><div class ='def text'>    html =  "<!DOCTYPE html><html lang='en'><head><title>Code Outline</title>"
</div>
<div class ='def text'>    html += "<style> * {font-weight:bold;padding-left:2rem;}"
</div>
<div class ='def text'>    html += ".filename {padding-left:0em;}"
</div>
<div class ='def text'>    html += ".docstring { font-weight:normal; color:green;}"
</div>
<div class ='def text'>    html += ".docstring.text { font-weight:normal; color:green;}"
</div>
<div class ='def text'>    html += ".class {color:blue;}"
</div>
<div class ='def text'>    html += ".def {color:orange; }"
</div>
<div class ='def text'>    html += ".text {color:black; font-size:1rem; font-weight:normal; }"
</div>
<div class ='def text'>    html += "</style></head><body>"
</div>
<div class ='def text'>    return html
</div>
<div class ='def text'>
</div>
</details><details><summary><span class='def'>def doc_html(doc, verbose = False):</span></summary><div class ='def text'>    html = ""
</div>
<div class ='def text'>    for i,obj in enumerate(doc.objects):
</div>
<div class ='def text'>        if(verbose):
</div>
<div class ='def text'>            print(f"Level {obj.indent_level} object, firstline =  {obj.firstline}")
</div>
<div class ='def text'>            for l in obj.lines:
</div>
<div class ='def text'>                print(f"{'    ' * obj.indent_level} {l.replace('\n','')}")
</div>
<div class ='def text'>        nextobj = doc.objects[(i+1) % len(doc.objects)]
</div>
<div class ='def text'>        if(nextobj.indent_level > obj.indent_level):
</div>
<div class ='def text'>            html += f"<details><summary><span class ='{obj.html_class}'>{obj.firstline}</span></summary>"
</div>
<div class ='def text'>        else:
</div>
<div class ='def text'>            html += f"<details><summary><span class='{obj.html_class}'>{obj.firstline}</span></summary>"
</div>
<div class ='def text'>            for line in obj.lines[1:]:
</div>
<div class ='def text'>                html += f"<div class ='{obj.html_class} text'>{line}</div>\n"
</div>
<div class ='def text'>            html += "</details>"
</div>
<div class ='def text'>        if(nextobj.indent_level < obj.indent_level):
</div>
<div class ='def text'>            html += "</details>"
</div>
<div class ='def text'>    return html
</div>
<div class ='def text'>            
</div>
</details><details><summary><span class='def'>def main():</span></summary><div class ='def text'>    html = html_head()
</div>
<div class ='def text'>
</div>
<div class ='def text'>    filepath = ""
</div>
<div class ='def text'>    verbose = True
</div>
<div class ='def text'>    for fname  in ["make_outline.py"]:
</div>
<div class ='def text'>        html += f"<div class = 'filename'>{fname}</div>"
</div>
<div class ='def text'>        doc = get_doc(filepath + fname, ['class','def','docstring','text'])
</div>
<div class ='def text'>        html += doc_html(doc)
</div>
<div class ='def text'>               
</div>
<div class ='def text'>    outname = "outline.html"
</div>
<div class ='def text'>    with open(outname, "w", encoding="utf-8") as f:
</div>
<div class ='def text'>        f.write(html)
</div>
<div class ='def text'>
</div>
<div class ='def text'>    print(f"\n\nOutline written to {outname}")
</div>
<div class ='def text'>
</div>
<div class ='def text'>if __name__ == "__main__":
</div>
<div class ='def text'>    main()
</div>
<div class ='def text'>
</div>
</details>