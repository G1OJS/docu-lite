<!DOCTYPE doc_html><doc_html lang='en'>
<head>
<title>Code Outline</title><style>
 * {font-weight:bold;padding-left:2rem;}
.filename {padding-left:0em;}
.class {color:blue;}
.def {color:orange; }
.docstring {color:green;}
.text {color:black;}
.inner {font-size:1rem; font-weight:normal; white-space: pre;}
.def.inner {color:black;}
.class.inner {color:black;}
</style>
</head>
<body>
<div class = 'filename'>docu-lite.py</div><details><summary><span class ='docstring'>docstring</span></summary>
<span class ='docstring inner'>    This is a demo of docu-lite semi-automatic documentation, using this same
</span>
<span class ='docstring inner'>    file as the input test case. To try it on your own files,
</span>
<span class ='docstring inner'>    change these lines below:
</span>
<span class ='docstring inner'>        filepath = &quot;&quot;
</span>
<span class ='docstring inner'>        for fname  in [&quot;docu-lite.py&quot;]:
</span>
<span class ='docstring inner'>    Remember that if you use a path containing &quot;\&quot;, you&#x27;ll need to escape them by
</span>
<span class ='docstring inner'>    adding another &quot;\&quot; e.g. filepath = &quot;C:\\users\\me\\mydocs\\test.py&quot;
</span>
<span class ='docstring inner'>
</span>
<span class ='docstring inner'>    This is the initial version with everything contained in one file.
</span>
<span class ='docstring inner'>
</span>
<span class ='docstring inner'>    Future versions may grow to a library-based project with different HTML generators etc
</span>
<span class ='docstring inner'>
</span>
</details>
<details><summary><span class ='text'>text</span></summary>
<span class ='text inner'>import html
</span>
<span class ='text inner'>
</span>
</details>
<details><summary><span class ='class'>class docobj:</span></summary>
<details><summary><span class ='def'>def __init__(self, firstline):</span></summary>
<span class ='def inner'>        self.firstline = firstline.strip()
</span>
<span class ='def inner'>        self.html_class = self.firstline.split(&quot; &quot;)[0]
</span>
<span class ='def inner'>        self.docstring =[]
</span>
<span class ='def inner'>        self.lines = []
</span>
<span class ='def inner'>        self.indent_spaces = len(firstline) - len(firstline.lstrip())
</span>
<span class ='def inner'>        self.indent_level = 0
</span>
<span class ='def inner'>
</span>
</details>
</details>
<details><summary><span class ='class'>class get_doc:</span></summary>
<details><summary><span class ='def'>def __init__(self,filepath, objtypes):</span></summary>
<details><summary><span class ='docstring'>docstring</span></summary>
<span class ='docstring inner'>            document-level properties and file reader / preprocessor
</span>
<span class ='docstring inner'>            completes with self.objects containing parsed docobjects
</span>
</details>
<details><summary><span class ='text'>text</span></summary>
<span class ='text inner'>        self.objects = []
</span>
<span class ='text inner'>        indent_level = 0
</span>
<span class ='text inner'>        indent_spaces = 0
</span>
<span class ='text inner'>        # get input file into lines
</span>
<span class ='text inner'>        with open(filepath,&quot;r&quot;) as f:
</span>
<span class ='text inner'>            lines = f.readlines()
</span>
<span class ='text inner'>
</span>
<span class ='text inner'>        # process docstrings to a common format:
</span>
<span class ='text inner'>        #   ignore &quot;&quot;&quot;text&quot;&quot;&quot; and &quot;&quot;&quot;text\ntext&quot;&quot;&quot;, otherwise:
</span>
<span class ='text inner'>        #    - replace all opening docstring markers with &#x27;docstring&#x27;
</span>
<span class ='text inner'>        #    - replace all closing docstring makers with &#x27;text&#x27;
</span>
<span class ='text inner'>        opening = True
</span>
<span class ='text inner'>        for idx, line in enumerate(lines):
</span>
<span class ='text inner'>            if(line.strip() == &#x27;&quot;&quot;&quot;&#x27;):
</span>
<span class ='text inner'>                rep = &#x27;docstring&#x27; if opening else &#x27;text&#x27;
</span>
<span class ='text inner'>                opening = not opening
</span>
<span class ='text inner'>                lines[idx] = line.replace(&#x27;&quot;&quot;&quot;&#x27;,rep)
</span>
<span class ='text inner'>
</span>
<span class ='text inner'>        # find document objects and remember the line number they start at
</span>
<span class ='text inner'>        line_index = []
</span>
<span class ='text inner'>        for line_no, line in enumerate(lines):
</span>
<span class ='text inner'>            for p in objtypes:
</span>
<span class ='text inner'>                if line.strip().startswith(p):
</span>
<span class ='text inner'>                    self.objects.append(docobj(line))
</span>
<span class ='text inner'>                    line_index.append(line_no)
</span>
<span class ='text inner'>
</span>
<span class ='text inner'>        # fill the object.lines[] with the text within the object
</span>
<span class ='text inner'>        for obj_ind, obj_start_line_no in enumerate(line_index):
</span>
<span class ='text inner'>            obj = self.objects[obj_ind]
</span>
<span class ='text inner'>            last_line = line_index[obj_ind+1] if obj_ind &lt; len(self.objects)-1 else len(lines)
</span>
<span class ='text inner'>            for obj_line_ind in range(obj_start_line_no, last_line):
</span>
<span class ='text inner'>                obj.lines.append(f&quot;{lines[obj_line_ind]}&quot;)
</span>
<span class ='text inner'>
</span>
<span class ='text inner'>        # tell the object what its indent level is within the document
</span>
<span class ='text inner'>        indents =[0]
</span>
<span class ='text inner'>        for obj in self.objects:
</span>
<span class ='text inner'>            if(obj.indent_spaces &gt; indents[-1]):
</span>
<span class ='text inner'>                indents.append(obj.indent_spaces)
</span>
<span class ='text inner'>            obj.indent_level = indents.index(obj.indent_spaces)
</span>
<span class ='text inner'>
</span>
<span class ='text inner'>
</span>
</details>
</details>
</details>
<details><summary><span class ='def'>def html_head():</span></summary>
<span class ='def inner'>    doc_html =  &quot;&lt;!DOCTYPE doc_html&gt;&lt;doc_html lang=&#x27;en&#x27;&gt;\n&lt;head&gt;\n&lt;title&gt;Code Outline&lt;/title&gt;&quot;
</span>
<span class ='def inner'>    doc_html += &quot;&lt;style&gt;\n * {font-weight:bold;padding-left:2rem;}\n&quot;
</span>
<span class ='def inner'>    doc_html += &quot;.filename {padding-left:0em;}\n&quot;
</span>
<span class ='def inner'>    doc_html += &quot;.class {color:blue;}\n&quot;
</span>
<span class ='def inner'>    doc_html += &quot;.def {color:orange; }\n&quot;
</span>
<span class ='def inner'>    doc_html += &quot;.docstring {color:green;}\n&quot;
</span>
<span class ='def inner'>    doc_html += &quot;.text {color:black;}\n&quot;
</span>
<span class ='def inner'>    doc_html += &quot;.inner {font-size:1rem; font-weight:normal; white-space: pre;}\n&quot;
</span>
<span class ='def inner'>    doc_html += &quot;.def.inner {color:black;}\n&quot;
</span>
<span class ='def inner'>    doc_html += &quot;.class.inner {color:black;}\n&quot;
</span>
<span class ='def inner'>    doc_html += &quot;&lt;/style&gt;\n&lt;/head&gt;\n&quot;
</span>
<span class ='def inner'>    return doc_html
</span>
<span class ='def inner'>
</span>
</details>
<details><summary><span class ='def'>def doc_body(doc, verbose = False):</span></summary>
<span class ='def inner'>    doc_html = &quot;&quot;
</span>
<span class ='def inner'>    for i,obj in enumerate(doc.objects):
</span>
<span class ='def inner'>        if(verbose):
</span>
<span class ='def inner'>            print(f&quot;Level {obj.indent_level} object, firstline =  {obj.firstline}&quot;)
</span>
<span class ='def inner'>            for l in obj.lines:
</span>
<span class ='def inner'>                print(f&quot;{&#x27;    &#x27; * obj.indent_level} {l.replace(&#x27;\n&#x27;,&#x27;&#x27;)}&quot;)
</span>
<span class ='def inner'>        nextobj = doc.objects[(i+1) % len(doc.objects)]
</span>
<span class ='def inner'>        doc_html += f&quot;&lt;details&gt;&lt;summary&gt;&lt;span class =&#x27;{obj.html_class}&#x27;&gt;{obj.firstline}&lt;/span&gt;&lt;/summary&gt;\n&quot;
</span>
<span class ='def inner'>        if(nextobj.indent_level &lt;= obj.indent_level):
</span>
<span class ='def inner'>            for line in obj.lines[1:]:
</span>
<span class ='def inner'>                doc_html += f&quot;&lt;span class =&#x27;{obj.html_class} inner&#x27;&gt;{html.escape(line)}&lt;/span&gt;\n&quot;
</span>
<span class ='def inner'>            for i in range(obj.indent_level - nextobj.indent_level + 1):
</span>
<span class ='def inner'>                doc_html += &quot;&lt;/details&gt;\n&quot;
</span>
<span class ='def inner'>    return doc_html
</span>
<span class ='def inner'>            
</span>
</details>
<details><summary><span class ='def'>def main():</span></summary>
<details><summary><span class ='docstring'>docstring</span></summary>
<span class ='docstring inner'>        Another docstring for testing
</span>
</details>
<details><summary><span class ='text'>text</span></summary>
<span class ='text inner'>    doc_html = html_head()
</span>
<span class ='text inner'>    doc_html += &quot;&lt;body&gt;\n&quot;
</span>
<span class ='text inner'>
</span>
<span class ='text inner'>    filepath = &quot;&quot;
</span>
<span class ='text inner'>    for fname  in [&quot;docu-lite.py&quot;]:
</span>
<span class ='text inner'>        doc_html += f&quot;&lt;div class = &#x27;filename&#x27;&gt;{fname}&lt;/div&gt;&quot;
</span>
<span class ='text inner'>        doc = get_doc(filepath + fname, [&#x27;class&#x27;,&#x27;def&#x27;,&#x27;docstring&#x27;,&#x27;text&#x27;])
</span>
<span class ='text inner'>        doc_html += doc_body(doc, verbose = False)
</span>
<span class ='text inner'>
</span>
<span class ='text inner'>    doc_html += &quot;&lt;/body&gt;\n&quot;
</span>
<span class ='text inner'>    outname = &quot;outline.html&quot;
</span>
<span class ='text inner'>    with open(outname, &quot;w&quot;, encoding=&quot;utf-8&quot;) as f:
</span>
<span class ='text inner'>        f.write(doc_html)
</span>
<span class ='text inner'>
</span>
<span class ='text inner'>    print(f&quot;\n\nOutline written to {outname}&quot;)
</span>
<span class ='text inner'>
</span>
<span class ='text inner'>if __name__ == &quot;__main__&quot;:
</span>
<span class ='text inner'>    main()
</span>
<span class ='text inner'>
</span>
</details>
</details>
</body>
