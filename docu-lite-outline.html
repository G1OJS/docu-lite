<!DOCTYPE html><html lang='en'>
<head>
<title>docu-lite-outline.html</title><link rel='stylesheet' href='./docu-lite-style.css' /><body>
<span class = 'filename'>doculite.py</span><br><details><summary><span class ='docstring signature'>docstring</span></summary>
<pre class ='docstring content'>    This is a demo of docu-lite semi-automatic documentation, using this same
    file as the input test case. To try it on your own files,
    change the appropriate settings in docu-lite.ini
</pre>
</details>
<details><summary><span class ='body signature'>body</span></summary>
<pre class ='body content'>import html
import glob
import os
import configparser
import argparse

</pre>
</details>
<details><summary><span class ='def signature'>def get_config():</span></summary>
<pre class ='def content'>    DEFAULT_INI = &quot;&quot;&quot;[input] \npattern = ./*.py\n\n[output]\nhtml = docu-lite-outline.html\ncss = docu-lite-style.css\ndocumentation_mode = off&quot;&quot;&quot;
    DEFAULT_INI_FILE = &quot;docu-lite.ini&quot;

    parser = argparse.ArgumentParser(add_help=False)
    parser.add_argument(&quot;--config&quot;, default = DEFAULT_INI_FILE)
    args, _ = parser.parse_known_args()
    path = args.config

    if not os.path.exists(path):
        if path != DEFAULT_INI_FILE:
            print(f&quot;Config file not found: {path}. Is there a typo?&quot;)
            sys.exit(1)
        else:
            print(f&quot;No config file found â€” creating default &#x27;{path}&#x27;&quot;)
            with open(path, &quot;w&quot;) as f:
                f.write(DEFAULT_INI)

    print(f&quot;Using config {path}&quot;)
    config = configparser.ConfigParser()
    config.read(path)
    return config

</pre>
</details>
<details><summary><span class ='class signature'>class docobj:</span></summary>
<details><summary><span class ='docstring signature'>docstring</span></summary>
<pre class ='docstring content'>        structure to contain information about each object in the document
</pre>
</details>
<details><summary><span class ='body signature'>body</span></summary>
<pre class ='body content'></pre>
</details>
<details><summary><span class ='def signature'>def __init__(self, signature):</span></summary>
<pre class ='def content'>        self.signature = signature.strip()                              # first line of the object including the def, class etc
        self.indent_spaces = len(signature) - len(signature.lstrip())   # number of spaces up to first letter in signature line
        self.indent_level = 0                                           # indent level of this object
        self.object_type = self.signature.split(&quot; &quot;)[0]                 # see object_signatures=[] in get_doc_objects for possible values
        self.content_start = 0                                          # index of line file_lines one after first line of object
        self.content_end = 0                                            # index of line file_lines containing last line of object

</pre>
</details>
</details>
<details><summary><span class ='def signature'>def get_doc_objects(file_lines):</span></summary>
<details><summary><span class ='docstring signature'>docstring</span></summary>
<pre class ='docstring content'>            document-level properties
            converts document into set of docobj in self.objects
</pre>
</details>
<details><summary><span class ='body signature'>body</span></summary>
<pre class ='body content'>        object_signatures = [&#x27;class&#x27;,&#x27;def&#x27;,&#x27;docstring&#x27;,&#x27;body&#x27;]
        objects = []
        indent_level = 0
        indent_spaces = 0

        # replace all opening docstring markers with &#x27;docstring&#x27; and closing tags with &#x27;body&#x27;
        # so &#x27;body&#x27; means otherwise unclassified content following a docstring
        # and in the example css is given the same style as unclassified content following def and class
        opening_tag = True
        for line_no, line in enumerate(file_lines):
            if(line.strip() == &#x27;&quot;&quot;&quot;&#x27;):
                file_lines[line_no] = line.replace(&#x27;&quot;&quot;&quot;&#x27;,&#x27;docstring&#x27; if opening_tag else &#x27;body&#x27;)
                opening_tag = not opening_tag
          
        # find and create document objects and tell them the line numbers
        # that their content starts and ends at
        for line_no, line in enumerate(file_lines):
            for p in object_signatures:
                if line.strip().startswith(p):
                    obj = docobj(line)
                    obj.content_start = line_no + 1         # start of this object
                    if(len(objects) &gt; 0):           
                        objects[-1].content_end = (line_no) # end of previous object
                    objects.append(obj)
        if(len(objects)&gt;1):
            objects[-1].content_end = len(file_lines)            # end of last object in document
               
        # tell the object what its indent level is within the document
        indents =[0]
        for obj in objects:
            if(obj.indent_spaces &gt; indents[-1]):
                indents.append(obj.indent_spaces)
            obj.indent_level = indents.index(obj.indent_spaces)
        return objects


</pre>
</details>
</details>
</details>
<details><summary><span class ='def signature'>def _signature_html(obj_type, obj_signature, open_details = True):</span></summary>
<pre class ='def content'>    # write the signature of the object with a summary / details tag
    htm = &quot;&lt;details&gt;&lt;summary&gt;&quot; if open_details else &quot;&lt;div&gt;&quot;
    htm += f&quot;&lt;span class =&#x27;{obj_type} {&#x27;signature&#x27;}&#x27;&gt;{obj_signature}&lt;/span&gt;&quot;
    htm += &quot;&lt;/summary&gt;&quot; if open_details else &quot;&lt;/div&gt;&quot;
    return htm + &quot;\n&quot;

</pre>
</details>
<details><summary><span class ='def signature'>def _content_html(file_lines, object_type, start_no, end_no):</span></summary>
<pre class ='def content'>    # write &#x27;content&#x27; inside &lt;pre&gt;&lt;/pre&gt;
    htm = f&quot;&lt;pre class =&#x27;{object_type} content&#x27;&gt;&quot;
    for line in file_lines[start_no:end_no]:
        htm += f&quot;{html.escape(line)}&quot;
    htm += &quot;&lt;/pre&gt;\n&quot;
    return htm

</pre>
</details>
<details><summary><span class ='def signature'>def _close_details(n_times):</span></summary>
<pre class ='def content'>    return &quot;&lt;/details&gt;\n&quot; * n_times

</pre>
</details>
<details><summary><span class ='def signature'>def object_list_to_HTML(file_lines, doc_objects):</span></summary>
<details><summary><span class ='docstring signature'>docstring</span></summary>
<pre class ='docstring content'>        converts list of doc_objects into HTML
</pre>
</details>
<details><summary><span class ='body signature'>body</span></summary>
<pre class ='body content'>    doc_html = &quot;&quot;
    for i,obj in enumerate(doc_objects):
        nextobj = doc_objects[(i+1) % len(doc_objects)]
        
        doc_html += _signature_html(obj.object_type, obj.signature, open_details = True)
        if(nextobj.indent_level &lt;= obj.indent_level):
            doc_html += _content_html(file_lines, obj.object_type, obj.content_start, obj.content_end)
            doc_html += _close_details(obj.indent_level - nextobj.indent_level + 1)
            
    return doc_html

</pre>
</details>
</details>
<details><summary><span class ='def signature'>def object_list_to_documentation_HTML(file_lines, doc_objects):</span></summary>
<details><summary><span class ='docstring signature'>docstring</span></summary>
<pre class ='docstring content'>        converts list of doc_objects into HTML
</pre>
</details>
<details><summary><span class ='body signature'>body</span></summary>
<pre class ='body content'>    doc_html = &quot;&quot;
    for i,obj in enumerate(doc_objects):
        nextobj = doc_objects[(i+1) % len(doc_objects)]

   #     doc_html += _signature_html(obj.object_type, obj.signature, open_details = True)
   #     if(nextobj.indent_level &lt;= obj.indent_level):
   #         doc_html += _content_html(file_lines, obj.object_type, obj.content_start, obj.content_end)
   #         doc_html += _close_details(obj.indent_level - nextobj.indent_level + 1)        
        
        if(obj.object_type not in [&#x27;body&#x27;,&#x27;docstring&#x27;]):
            doc_html += &quot;&lt;hr&gt;&quot;
            doc_html += _signature_html(obj.object_type, obj.signature.replace(&#x27;def &#x27;,&#x27;&amp;nbsp&amp;nbsp&amp;nbsp&#x27;), open_details = False)
        if(obj.object_type == &quot;docstring&quot;):
            doc_html += _content_html(file_lines, obj.object_type, obj.content_start, obj.content_end)


            
    return doc_html
            
</pre>
</details>
</details>
<details><summary><span class ='def signature'>def main():</span></summary>
<details><summary><span class ='docstring signature'>docstring</span></summary>
<pre class ='docstring content'>        Another docstring for testing
</pre>
</details>
<details><summary><span class ='body signature'>body</span></summary>
<pre class ='body content'>    version_string = &quot;v0.7.3&quot;
    soft_string = f&quot;Docu-lite {version_string} by Alan Robinson: github.com/G1OJS/docu-lite/&quot;
    print(f&quot;{soft_string}\n&quot;)
    config = get_config()
    input_pattern = config.get(&quot;input&quot;, &quot;pattern&quot;)
    output_name = config.get(&quot;output&quot;, &quot;html&quot;)
    style_sheet = config.get(&quot;output&quot;, &quot;css&quot;)
    documentation_mode = config.get(&quot;output&quot;, &quot;documentation_mode&quot;)

    print(f&quot;Running with \n \n[input]\npattern = {input_pattern}\n[output]\nhtml = {output_name}\ncss = {style_sheet}\ndocumentation_mode = {documentation_mode}\n&quot;)
    
    # start the output html
    output_html =  f&quot;&lt;!DOCTYPE html&gt;&lt;html lang=&#x27;en&#x27;&gt;\n&lt;head&gt;\n&lt;title&gt;{output_name}&lt;/title&gt;&quot;

    # look for specified or default css, if not found write a new one and use that
    DEFAULT_CSS = &quot;* {margin-left:2rem;} \n.filename {font-weight:bold; color:grey; font-size:2rem;} \
        \n.signature {font-weight:bold; margin-left:2rem;}\n.class {color:blue;} \
        \n.def {color:orange; }\n.docstring {color:darkgreen;}\n \
        \n.content {border-left: 2px solid #ccc; color:black; padding-left: 1em; background: #f9f9f9;}\n.docstring {color:green;}&quot;

    DEFAULT_CSS_DOCS = &quot;* {margin-left:2rem; background: #e6f9ff;} \n.filename {font-weight:bold; color:grey; font-size:2rem;} \
        \n.signature {font-weight:bold; margin-left:2rem;}\n.class {color:black; font-size:1.5rem;} \
        \n.def {color:black; }\n.docstring {color:darkgreen;}\n \
        \n.content {color:black; padding-left: 1em; }\n.docstring {color:green;}&quot;

    try:
        with open(style_sheet, &quot;r&quot;, encoding=&quot;utf-8&quot;) as f:
            pass
    except (FileNotFoundError, OSError):
        print(f&quot;Couldn&#x27;t open style sheet {style_sheet}: creating default\n&quot;)
        with open(style_sheet, &quot;w&quot;, encoding=&quot;utf-8&quot;) as f:
            f.write(DEFAULT_CSS if (documentation_mode==&quot;off&quot;) else DEFAULT_CSS_DOCS)
    output_html += f&quot;&lt;link rel=&#x27;stylesheet&#x27; href=&#x27;./{style_sheet}&#x27; /&gt;&quot;

    # start html body and process input files
    output_html += &quot;&lt;body&gt;\n&quot;
    print(f&quot;Scanning for input files in {input_pattern}&quot;)
    for filepath in glob.glob(input_pattern):
        filename = os.path.basename(filepath)
        print(f&quot;Found file: {filename}&quot;)
        with open(filepath,&quot;r&quot;) as f:
            file_lines = f.readlines()
        if(len(file_lines) ==0):
            print(f&quot;File: {filename} has no content - skipping&quot;)
            continue
        output_html += f&quot;&lt;span class = &#x27;filename&#x27;&gt;{filename}&lt;/span&gt;&lt;br&gt;&quot;
        doc_objects = get_doc_objects(file_lines)
        if(documentation_mode == &quot;off&quot;):
            output_html += object_list_to_HTML(file_lines, doc_objects)
        else:
            output_html += object_list_to_documentation_HTML(file_lines, doc_objects)

    # write footer
    output_html += f&quot;\n&lt;br&gt;&lt;br&gt;&lt;span style = &#x27;font-size:0.8em;color:#666;border-top:1px solid #ddd; &quot;
    output_html += f&quot;font-style:italic&#x27;&gt;Made with {soft_string}&lt;/span&gt;&quot;

    # close html body and write the file
    output_html += &quot;&lt;/body&gt;\n&quot;
    with open(output_name, &quot;w&quot;, encoding=&quot;utf-8&quot;) as f:
        f.write(output_html)
    print(f&quot;\nOutline written to {output_name},&quot;)
    print(f&quot;linking to style sheet {style_sheet}&quot;)

if __name__ == &quot;__main__&quot;:
    main()

</pre>
</details>
</details>

<br><br><span style = 'font-size:0.8em;color:#666;border-top:1px solid #ddd; font-style:italic'>Made with Docu-lite v0.7.0 by Alan Robinson: github.com/G1OJS/docu-lite/</span></body>
